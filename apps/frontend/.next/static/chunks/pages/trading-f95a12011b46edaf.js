(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{2585:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/trading",function(){return n(6429)}])},2930:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(2322),r=n(9097),i=n.n(r);function s(e){let{children:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("nav",{style:{display:"flex",gap:16,padding:16,borderBottom:"1px solid #1e293b",background:"#0f172a"},children:[(0,a.jsx)("b",{children:"CryptoBot"}),(0,a.jsx)(i(),{href:"/dashboard",children:"Dashboard"}),(0,a.jsx)(i(),{href:"/trading",children:"Trading"})]}),(0,a.jsx)("div",{className:"container",children:t})]})}},4271:function(e,t,n){"use strict";n.d(t,{F:function(){return r}});let a=n(3542).env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:3001",r={async runAnalysis(e){let t=await fetch("".concat(a,"/api/agents/run-analysis"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text());return t.json()},async generateTradePlan(e){let t=await fetch("".concat(a,"/api/agents/generate-trade-plan"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text());return t.json()},async validateTradePlan(e,t){let n=await fetch("".concat(a,"/api/risk/validate-trade-plan"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plan:e,profile:t})});if(!n.ok)throw Error(await n.text());return n.json()},async approvePaper(e,t,n){let r=await fetch("".concat(a,"/api/trades/approve-paper"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plan:e,riskCheckId:t,confirmations:n})});if(!r.ok)throw Error(await r.text());return r.json()},portfolio:async()=>(await fetch("".concat(a,"/api/portfolio"))).json(),liveStatus:async()=>(await fetch("".concat(a,"/api/live/status"))).json()}},6429:function(e,t,n){"use strict";let a;n.r(t),n.d(t,{default:function(){return b}});var r=n(2322),i=n(2930);let s=e=>{let t;let n=new Set,a=(e,a)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=a?a:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,i={setState:a,getState:r,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},s=t=e(a,r,i);return i},o=e=>e?s(e):s;var l=n(2784),c=n(1110);let{useDebugValue:u}=l,{useSyncExternalStoreWithSelector:d}=c,f=!1,p=e=>e,h=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?o(e):e,n=(e,n)=>(function(e,t=p,n){n&&!f&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),f=!0);let a=d(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return u(a),a})(t,e,n);return Object.assign(n,t),n};var y=n(4271);let v=(a=(e,t)=>({symbol:"BTCUSDT",timeframe:"1h",capital:1e5,loading:!1,analysis:void 0,plan:void 0,risk:void 0,approval:void 0,async runAgents(){e({loading:!0});try{let{symbol:n,timeframe:a,capital:r}=t(),i=await y.F.runAnalysis({symbol:n,timeframe:a,capital:r});e({analysis:i})}finally{e({loading:!1})}},async generatePlan(){e({loading:!0});try{let{analysis:n,symbol:a,timeframe:r,capital:i}=t();if(!n)throw Error("Run agents first");let s=await y.F.generateTradePlan({analysisId:n.id,symbol:a,timeframe:r,capital:i});e({plan:s})}finally{e({loading:!1})}},async validateRisk(n){e({loading:!0});try{let{plan:a}=t();if(!a)throw Error("Generate plan first");let r=await y.F.validateTradePlan(a,n);e({risk:r})}finally{e({loading:!1})}},async approvePaper(){e({loading:!0});try{let{plan:n,risk:a}=t();if(!n||!a)throw Error("Missing plan/risk");if("ok"!==a.status)throw Error("Risk not OK");let r=await y.F.approvePaper(n,a.id,["Confirm paper"]);e({approval:r})}finally{e({loading:!1})}},reset(){e({analysis:void 0,plan:void 0,risk:void 0,approval:void 0})}}))?h(a):h;function b(){let e=v();return(0,r.jsxs)(i.Z,{children:[(0,r.jsx)("h1",{children:"Trading Flow"}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("b",{children:"1) Run Agents"}),(0,r.jsx)("p",{children:(0,r.jsx)("button",{className:"btn",onClick:e.runAgents,children:"Run"})}),e.analysis&&(0,r.jsx)("pre",{children:JSON.stringify(e.analysis,null,2)})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("b",{children:"2) Plan"}),(0,r.jsx)("p",{children:(0,r.jsx)("button",{className:"btn",onClick:e.generatePlan,disabled:!e.analysis,children:"Generate"})}),e.plan&&(0,r.jsx)("pre",{children:JSON.stringify(e.plan,null,2)})]})]}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("b",{children:"3) Risk"}),(0,r.jsx)("p",{children:(0,r.jsx)("button",{className:"btn",onClick:()=>e.validateRisk({profile:"neutral",maxPositionPct:.1,maxDailyLossPct:.05,requireKillSwitch:!0}),disabled:!e.plan,children:"Validate"})}),e.risk&&(0,r.jsx)("pre",{children:JSON.stringify(e.risk,null,2)})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("b",{children:"4) Approve"}),(0,r.jsx)("p",{children:(0,r.jsx)("button",{className:"btn",onClick:e.approvePaper,disabled:!e.risk||"ok"!==e.risk.status,children:"Approve Paper"})})]})]})]})}},1458:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=n(2784),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useState,s=a.useEffect,o=a.useLayoutEffect,l=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),a=i({inst:{value:n,getSnapshot:t}}),r=a[0].inst,u=a[1];return o(function(){r.value=n,r.getSnapshot=t,c(r)&&u({inst:r})},[e,n,t]),s(function(){return c(r)&&u({inst:r}),e(function(){c(r)&&u({inst:r})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:u},4141:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=n(2784),r=n(3100),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=r.useSyncExternalStore,o=a.useRef,l=a.useEffect,c=a.useMemo,u=a.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,a,r){var d=o(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;var p=s(e,(d=c(function(){function e(e){if(!l){if(l=!0,s=e,e=a(e),void 0!==r&&f.hasValue){var t=f.value;if(r(t,e))return o=t}return o=e}if(t=o,i(s,e))return t;var n=a(e);return void 0!==r&&r(t,n)?(s=e,t):(s=e,o=n)}var s,o,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,a,r]))[0],d[1]);return l(function(){f.hasValue=!0,f.value=p},[p]),u(p),p}},3100:function(e,t,n){"use strict";e.exports=n(1458)},1110:function(e,t,n){"use strict";e.exports=n(4141)}},function(e){e.O(0,[72,888,774,179],function(){return e(e.s=2585)}),_N_E=e.O()}]);