const BASE=process.env.NEXT_PUBLIC_BACKEND_URL||'http://localhost:3001';
const workspaceId=process.env.NEXT_PUBLIC_WORKSPACE_ID||'demo-workspace';
const userId=process.env.NEXT_PUBLIC_USER_ID||'demo-user';
const baseHeaders={'Content-Type':'application/json','x-workspace-id':workspaceId,'x-user-id':userId};
export const tradingFlowApi={ async runAnalysis(p:any){ const r=await fetch(`${BASE}/api/agents/run-analysis`,{method:'POST',headers:baseHeaders,body:JSON.stringify(p)}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, async generateTradePlan(p:any){ const r=await fetch(`${BASE}/api/agents/generate-trade-plan`,{method:'POST',headers:baseHeaders,body:JSON.stringify(p)}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, async validateTradePlan(plan:any,profile:any){ const r=await fetch(`${BASE}/api/risk/validate-trade-plan`,{method:'POST',headers:baseHeaders,body:JSON.stringify({plan,profile})}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, async approvePaper(plan:any,riskCheckId:string,confirmations:string[]){ const r=await fetch(`${BASE}/api/trades/approve-paper`,{method:'POST',headers:baseHeaders,body:JSON.stringify({plan,riskCheckId,confirmations})}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, async getRiskProfiles(){ const r=await fetch(`${BASE}/api/risk/profiles`,{headers:baseHeaders}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, async getRiskUserSettings(){ const r=await fetch(`${BASE}/api/risk/user-settings`,{headers:baseHeaders}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, async setRiskUserSettings(profile:any){ const r=await fetch(`${BASE}/api/risk/user-settings`,{method:'POST',headers:baseHeaders,body:JSON.stringify(profile)}); if(!r.ok) throw new Error(await r.text()); return r.json(); }, portfolio: async()=> (await fetch(`${BASE}/api/portfolio`,{headers:baseHeaders})).json(), liveStatus: async()=> (await fetch(`${BASE}/api/live/status`,{headers:baseHeaders})).json() }
